<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="board">

	<resultMap id="boardResultMap" type="hashmap">
	  <result property="rnum" column="RNUM"/>
	  <result property="boardSeq" column="BOARD_SEQ"/>
	  <result property="title" column="TITLE"/>
	  <result property="cont" column="CONT"/>
	  <result property="writeUserSeq" column="WRITE_USER_SEQ"/>
	  <result property="writeDate" column="WRITE_DATE"/>
	  <result property="depth" column="DEPTH"/>
	  <result property="parentBoardSeq" column="PARENT_BOARD_SEQ"/>
	  <result property="secretYn" column="SECRET_YN"/>
	</resultMap>
     
    <select id="getBoardList" parameterType="hashmap" resultMap="boardResultMap">
    
   		SELECT A.* FROM (
			SELECT @rownum := @rownum+1 AS RNUM, BOARD_SEQ,TITLE,CONT,WRITE_USER_SEQ,WRITE_DATE,DEPTH,PARENT_BOARD_SEQ,SECRET_YN
			FROM T_BOARD  , (SELECT @rownum := 0) AS R
        ) A
         WHERE RNUM BETWEEN #{onePageCnt} * ( #{pageNum} - 1 ) + 1  AND #{onePageCnt} * ( '1' ); 
    </select>
    
     <select id="getBoardListCnt" parameterType="hashmap" resultType="int">
            SELECT count(1)
            FROM T_BOARD
        
    </select>
    
    <insert id="insertBoard" parameterType="hashmap">
    	INSERT INTO T_BOARD(BOARD_SEQ
					,TITLE
					,CONT
					,WRITE_USER_SEQ
					,WRITE_DATE
					,DEPTH
					,PARENT_BOARD_SEQ
					,SECRET_YN
					<if test="(secretYn != null) and (secretYn=='Y')">,SECRET_PASSWORD</if>) 
		VALUES(#{boardSeq}
				,#{title}
				,#{cont}
				,#{writeUserSeq}
				,now()
				,#{depth}
				,<if test="parentBoardSeq != null">#{parentBoardSeq}</if><if test="parentBoardSeq == null">#{boardSeq}</if>
				<if test="secretYn != null">,#{secretYn}</if><if test="secretYn == null">,'N'</if>
				<if test="(secretYn != null) and (secretYn=='Y')">,#{secretPassword}</if>
				
				)
    
    </insert>
     
</mapper>